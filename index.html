<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML File Editor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    header {
      width: 100%;
      background: #FF9933;
      padding: 10px 0;
      color: white;
      text-align: center;
      font-size: 20px;
    }

    textarea {
      width: 90%;
      height: 400px;
      margin: 20px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-family: monospace;
      font-size: 16px;
      padding: 10px;
      resize: none;
      white-space: pre-wrap;
    }

    .button-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    button, select, input[type="file"], input[type="text"] {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
    }

    button {
      background: #FF9933;
      color: white;
    }

    button:hover {
      background: #E88A2A;
    }

    select, input[type="text"] {
      background: #f1f1f1;
    }
  </style>
</head>
<body>
  <header>HTML File Editor</header>
  <textarea id="editor" placeholder="Write or edit your code here..."></textarea>
  
  <div class="button-container">
    <button onclick="copyCode()">Copy Code</button>
    <button onclick="changeFileName()">Change File Name</button>
    <button onclick="downloadCode()">Download</button>
    <button onclick="findWord()">Find Word</button>
    <button onclick="clearEditor()">Clear</button>
    <button onclick="runCode()">Run Code</button>
    <select id="fileExtension" onchange="updateExtension()">
      <option value=".html">.html</option>
      <option value=".css">.css</option>
      <option value=".js">.js</option>
      <option value=".py">.py</option>
      <option value=".php">.php</option>
      <option value=".txt">.txt</option>
      <option value=".lrc">.lrc</option> <!-- Added LRC option -->
    </select>
    <input type="file" accept=".html,.css,.js,.py,.php,.txt,.lrc" onchange="uploadFile(event)" />
  </div>
  
  <div class="button-container">
    <input type="text" id="fileUrl" placeholder="Enter file URL" style="width: 70%;" />
    <button onclick="downloadSourceCode()">Download File by Link</button>
  </div>

  <script>
    let fileName = 'new_file';
    let fileExtension = '.html';

    function copyCode() {
      const editor = document.getElementById('editor');
      editor.select();
      document.execCommand('copy');
      alert('Code copied to clipboard!');
    }

    function changeFileName() {
      const newFileName = prompt('Enter new file name:', fileName);
      if (newFileName) {
        fileName = newFileName;
        alert(`File name changed to ${fileName}${fileExtension}`);
      } else {
        alert('File name not changed.');
      }
    }

    function updateExtension() {
      const extensionDropdown = document.getElementById('fileExtension');
      fileExtension = extensionDropdown.value;
      alert(`File extension changed to ${fileExtension}`);
    }

    function downloadCode() {
      const editorContent = document.getElementById('editor').value;
      const blob = new Blob([editorContent], { type: 'text/plain' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `${fileName}${fileExtension}`; // Fixed PHP file extension issue
      link.click();
    }

    function uploadFile(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('editor').value = e.target.result;
        };
        reader.readAsText(file);
        const fileParts = file.name.split('.');
        fileName = fileParts.slice(0, -1).join('.');
        fileExtension = `.${fileParts[fileParts.length - 1]}`;
        document.getElementById('fileExtension').value = fileExtension;
      }
    }

    function clearEditor() {
      document.getElementById('editor').value = '';
    }

    function runCode() {
      const editorContent = document.getElementById('editor').value;
      const extension = fileExtension.toLowerCase();

      if (extension === '.js') {
        const newWindow = window.open('', '_blank');
        newWindow.document.write('<html><head><title>JavaScript Output</title></head><body>');
        newWindow.document.write('<h1>JavaScript Output</h1>');
        newWindow.document.write('<pre>');
        try {
          eval(editorContent);
        } catch (error) {
          newWindow.document.write(`Error: ${error.message}`);
        }
        newWindow.document.write('</pre></body></html>');
        newWindow.document.close();
      } else if (extension === '.html' || extension === '.css') {
        const newWindow = window.open('', '_blank');
        newWindow.document.write(editorContent);
        newWindow.document.close();
      } else {
        alert('This file type cannot be executed directly in the browser.');
      }
    }

    function downloadSourceCode() {
      const url = document.getElementById('fileUrl').value;

      if (!url) {
        alert('Please enter a URL.');
        return;
      }

      fetch(url)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`Error: ${response.status} - ${response.statusText}`);
          }
          return response.text();
        })
        .then((data) => {
          document.getElementById('editor').value = data;
          alert('File downloaded successfully and loaded into the editor.');
        })
        .catch((error) => {
          alert(`Failed to download file: ${error.message}`);
        });
    }
  </script>
</body>
</html>
